# Radiomics-Analysis-and-ML-for-Prognostic-Biomarkers-in-IPF
This repository contains the code for my master’s thesis on predicting Forced Vital Capacity (FVC) one year after baseline for Idiopathic Pulmonary Fibrosis (IPF) patients using clinical features, radiomic features from HRCT, and a combined radiomic + clinical (RC) setting.
The workflow includes image preprocessing, automated segmentation, radiomics extraction, feature selection pipelines, and regression models (Elastic Net, Partial Least Squares, Random Forest) with basic interpretability.

# Dataset (OSIC Pulmonary Fibrosis)

## Source
This project uses the **OSIC Pulmonary Fibrosis dataset** (Open Source Imaging Consortium).
The dataset is **not included in this repository** size restrictions.

## Contents
The dataset includes:
- **HRCT scans** (anonymized) for IPF patients
- **Clinical metadata** collected over time (longitudinal measurements such as FVC

## Pipeline Overview

![Pipeline Overview](https://github.com/YashodharPansuriya/Radiomics-Analysis-and-ML-for-Prognostic-Biomarkers-in-IPF/blob/main/Images/IPF_Pipeline.PNG)


## Setup

Clone the repository and install the dependencies:

```bash
git clone <your-repo-url>
cd <your-repo-folder>

python -m venv .venv
source .venv/bin/activate   

pip install -r requirements.txt


## Repository Overview 

This repository is organized according to the workflow used in the thesis.  
Each folder represents one major step of the pipeline, from Patients cohort selection to model training and result generation.

### Folder descriptions

- **`Patients_Data_Exploration/`**  
  Contains scripts for selecting the patient cohort from the OSIC dataset that is relevant to the thesis objective.

- **`Image_Preprocessing&Segmentation/`** 
  Code for Image preprocessing and automated lung segmentation (mask generation) used before radiomics extraction.  

- **`Radiomics_Extraction/`**  
  Script to extract radiomic features from segmented HRCT scans (e.g., using PyRadiomics).  

- **`EDA&Feature_selection/`**  
 Script for exploratory analysis of clinical variables (missing values, distributions, and correlations) and for implementing multiple feature selection pipelines (P1–P6) as well as the full feature set. 

- **`Model_Training/`**  
  Training and evaluation code for regression models:
  - Elastic Net (EN)
  - Partial Least Squares (PLS)
  - Random Forest (RF)  

- **`Trained_models/`**  
  Contains the saved trained models (EN, PLS, RF) for all predictor configurations used in the thesis: clinical-only (C), radiomics-only (R), and combined radiomics + clinical (RC). It also includes models trained on the reduced RC feature subsets generated by the feature-selection pipelines P1–P6.

- **`Radiomics_files/`**  
  Contains CSV files with the extracted radiomics features computed from the segmented HRCT images. These files are used as inputs for feature selection and model training.

---

## Recommended execution order (to reproduce results)

Run the folders in this order:

1. `Patients_Data_Exploration/`
2. `Image_Preprocessing&Segmentation/` 
3. `Radiomics_Extraction/`
4. `EDA&Feature_selection/`
5. `Model_Training/`


